<!DOCTYPE html>
<html>

<head>
    <title>Example</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!-- Bootstrap JS -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css">
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"></script>



</head>

<body>
    <div class="container">
        <h2>Data from Table</h2>
        <div id="data"></div>
    </div>

    <div style="height:300px;">
        <div id="map" class="w-100 h-100"></div>
    </div>
    <script>
        $(document).ready(function () {
            $.ajax({
                url: 'test.php', // change this to the url of your server-side script that fetches the data from the database
                type: 'get',
                dataType: 'json',
                success: function (response) {
                    var data = response.data;
                    var rows = '';
                    for (var i = 0; i < data.length; i++) {
                        rows += '<div class="row">';
                        rows += '<div class="col-3">' + data[i].date + '</div>'; // change this to the format of your data
                        rows += '<div class="col-3">' + data[i].starttime + '</div>'; // change this to the format of your data
                        rows += '<div class="col-3">' + data[i].endtime + '</div>'; // change this to the format of your data
                        rows += '<button class="btn btn-primary change-coordinates" data-longitude="' + data[i].longitude + '" data-latitude="' + data[i].latitude + '">Change Coordinates</button>'; // add a button with data-longitude and data-altitude attributes that contain the item's longitude and altitude
                        rows += '<button class="btn btn-danger remove-row" data-id="' + data[i].id + '">Remove</button>'; // add a button with a data-id attribute that contains the row id
                        rows += '</div>';
                    }
                    $('#data').html(rows);
                }
            })
        });

        // Set up the map
        var map = L.map('map').setView([31.80309338, 35.10942674], 7);
        // Add the tile layer
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        }).addTo(map);
        var markerLayer = L.layerGroup().addTo(map);

        function changeCoords(lat, lng) {
            // Remove existing marker layer from the map
            if (markerLayer) {
                map.removeLayer(markerLayer);
            }

            // Create a new marker layer and add it to the map
            markerLayer = L.layerGroup();
            var marker = L.marker([lat, lng]);
            markerLayer.addLayer(marker);
            map.addLayer(markerLayer);
            // Center the map on the new coordinates
            map.setView([lat, lng], 17);
        }


        $(document).on('click', '.change-coordinates', function () {
            var longitude = $(this).data('longitude'); // get the longitude from the data-longitude attribute
            var latitude = $(this).data('latitude'); // get the altitude from the data-altitude attribute
            changeCoords(latitude, longitude); // call the changeCoords function with the longitude and altitude

        });
    </script>
</body>

</html>